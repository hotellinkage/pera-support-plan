<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pera's 8-Week Aligned Support Plan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .header-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .user-select {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .user-select select {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
        }

        .overall-progress {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 200px;
        }

        .overall-progress-text {
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .progress-bar {
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .week-progress-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 8px;
        }

        .week-progress-container .progress-bar {
            flex: 1;
            background: #c8e6c9;
        }

        .week-progress-text {
            font-weight: bold;
            color: #2e7d32;
            min-width: 50px;
        }

        .last-edited {
            font-size: 0.85em;
            color: #666;
            font-style: italic;
            margin-top: 10px;
            padding: 8px 12px;
            background: #f5f5f5;
            border-radius: 6px;
            display: inline-block;
        }

        .comment-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            padding: 5px;
            opacity: 0.5;
            transition: all 0.2s;
        }

        .comment-btn:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .comment-btn.has-comment {
            opacity: 1;
            color: #667eea;
        }

        .comment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .comment-modal.active {
            display: flex;
        }

        .comment-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .comment-modal h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .comment-modal textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            min-height: 100px;
            resize: vertical;
        }

        .comment-modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: flex-end;
        }

        .comment-modal-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .comment-save-btn {
            background: #667eea;
            color: white;
        }

        .comment-cancel-btn {
            background: #e0e0e0;
            color: #333;
        }

        .info-section {
            background: #f8f9fa;
            padding: 30px 40px;
            border-bottom: 3px solid #667eea;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .info-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .info-card ul {
            list-style: none;
            padding-left: 0;
        }

        .info-card li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .info-card li:before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: #764ba2;
            font-weight: bold;
        }

        .content {
            padding: 40px;
        }

        .week-section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .week-section:hover {
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
            border-color: #667eea;
        }

        .week-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .week-header h2 {
            font-size: 1.5em;
        }

        .toggle-icon {
            font-size: 1.5em;
            transition: transform 0.3s ease;
        }

        .week-section.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .week-content {
            padding: 30px;
            background: white;
        }

        .week-section.collapsed .week-content {
            display: none;
        }

        .focus-area {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .focus-area h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .focus-items {
            display: grid;
            gap: 10px;
        }

        .focus-item {
            padding: 10px;
            background: white;
            border-radius: 6px;
            font-size: 0.95em;
        }

        .daily-routine {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #ffc107;
        }

        .daily-routine h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .tracker-section {
            margin-top: 30px;
            padding: 25px;
            background: #e8f4f8;
            border-radius: 10px;
            border-left: 4px solid #17a2b8;
        }

        .tracker-section h3 {
            color: #117a8b;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .day-checks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .day-check {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .day-check input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .day-check label {
            cursor: pointer;
            font-weight: 500;
        }

        .progress-checks {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }

        .progress-item label {
            flex: 1;
            font-weight: 500;
        }

        .status-buttons {
            display: flex;
            gap: 10px;
        }

        .status-btn {
            padding: 8px 16px;
            border: 2px solid #dee2e6;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9em;
        }

        .status-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .status-btn.active {
            border-color: currentColor;
            font-weight: bold;
        }

        .status-btn.mastered {
            color: #28a745;
        }

        .status-btn.mastered.active {
            background: #28a745;
            color: white;
        }

        .status-btn.developing {
            color: #ffc107;
        }

        .status-btn.developing.active {
            background: #ffc107;
            color: white;
        }

        .status-btn.needs-support {
            color: #dc3545;
        }

        .status-btn.needs-support.active {
            background: #dc3545;
            color: white;
        }

        .notes-area {
            margin-top: 20px;
        }

        .notes-area label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #117a8b;
        }

        .notes-area textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95em;
            resize: vertical;
            min-height: 80px;
        }

        .notes-area textarea:focus {
            outline: none;
            border-color: #17a2b8;
        }

        .save-btn {
            margin-top: 15px;
            padding: 12px 30px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);
        }

        .export-section {
            margin-top: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            text-align: center;
        }

        .export-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
            }
            
            .export-section {
                display: none;
            }
            
            .week-section {
                page-break-inside: avoid;
            }
            
            .week-content {
                display: block !important;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .status-buttons {
                flex-direction: column;
            }
            
            .status-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒŸ Pera's 8-Week Aligned Support Plan ğŸŒŸ</h1>
            <p>Waters Edge Elementary School - Grade 1</p>
            <p style="font-size: 0.9em; margin-top: 10px;">School + Eva Boothby + Home Support</p>

            <div class="header-controls">
                <div class="user-select">
                    <span>ğŸ‘¤</span>
                    <select id="currentUser" onchange="saveCurrentUser()">
                        <option value="">Select your name</option>
                        <option value="Erhan">Erhan</option>
                        <option value="Meral">Meral</option>
                        <option value="Eva">Eva</option>
                        <option value="Mrs. Frixione">Mrs. Frixione</option>
                    </select>
                </div>
                <div class="overall-progress">
                    <div class="overall-progress-text">ğŸ“Š Overall Progress: <span id="overallPercent">0%</span></div>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="overallProgressBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Modal -->
        <div class="comment-modal" id="commentModal">
            <div class="comment-modal-content">
                <h3>ğŸ’¬ Add Comment for <span id="commentDayLabel"></span></h3>
                <textarea id="commentText" placeholder="Write your comment about today's work..."></textarea>
                <div class="comment-modal-buttons">
                    <button class="comment-cancel-btn" onclick="closeCommentModal()">Cancel</button>
                    <button class="comment-save-btn" onclick="saveComment()">Save Comment</button>
                </div>
            </div>
        </div>

        <div class="info-section">
            <h2 style="color: #667eea; margin-bottom: 20px;">Program Overview</h2>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3 style="color: #764ba2; margin-bottom: 15px;">ğŸ“š Purpose</h3>
                <ul style="list-style: none; padding-left: 0;">
                    <li style="padding: 8px 0; padding-left: 25px; position: relative;">
                        <span style="position: absolute; left: 0; color: #667eea;">âœ“</span>
                        Align home support with Grade 1 classroom expectations and current instruction
                    </li>
                    <li style="padding: 8px 0; padding-left: 25px; position: relative;">
                        <span style="position: absolute; left: 0; color: #667eea;">âœ“</span>
                        Close transition gaps efficiently (especially English phonics automaticity and math fact fluency)
                    </li>
                    <li style="padding: 8px 0; padding-left: 25px; position: relative;">
                        <span style="position: absolute; left: 0; color: #667eea;">âœ“</span>
                        Support Pera emotionally by keeping work short, consistent, and confidence-building
                    </li>
                </ul>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <h3>ğŸ« School (Classroom Teacher)</h3>
                    <ul>
                        <li>Provides primary instruction</li>
                        <li>Monitors progress in class</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>ğŸ‘©â€ğŸ« Eva Boothby (2x/week)</h3>
                    <ul>
                        <li>Explicit teaching of weekly targets</li>
                        <li>Technique correction</li>
                        <li>45-60 min sessions</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>ğŸ  Home Support (Daily)</h3>
                    <ul>
                        <li>Build automaticity</li>
                        <li>Short daily practice (25-35 min)</li>
                        <li>Calm, predictable routine</li>
                    </ul>
                </div>
            </div>

            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #ffc107;">
                <h3 style="color: #856404; margin-bottom: 10px;">âš¡ Key Principle</h3>
                <p style="color: #856404; font-weight: 500;">Short and consistent. Stop while she still feels successful!</p>
            </div>
        </div>

        <div class="content">
            <!-- Week 1-2 -->
            <div class="week-section" data-week="1">
                <div class="week-header" onclick="toggleWeek(this)">
                    <h2>ğŸ“˜ Weeks 1-2: Stabilize Foundations</h2>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="week-content">
                    <div class="focus-area">
                        <h3>ğŸ“– ELA / Reading</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ”¤ Short vowels + CVC blending</div>
                            <div class="focus-item">ğŸ‘€ High-frequency (sight) words routine</div>
                            <div class="focus-item">âœï¸ Writing: complete sentences (capital letter + punctuation)</div>
                        </div>
                    </div>

                    <div class="focus-area">
                        <h3>ğŸ”¢ Math</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ“Š Counting & number sense</div>
                            <div class="focus-item">ğŸ”¢ Number recognition and writing numbers</div>
                            <div class="focus-item">â• Addition and subtraction (within 10 â†’ bridge to within 20)</div>
                        </div>
                    </div>

                    <div class="daily-routine">
                        <h3>ğŸ  Daily Home Routine (Mon-Fri, 25-35 minutes)</h3>
                        <p><strong>A) Phonics/Word Study (8-10 min):</strong> Sound review (1 min) â†’ Blending practice (4 min) â†’ Dictation (3-5 min)</p>
                        <p><strong>B) Reading with Raz-Plus (10-12 min):</strong> Listen once (if needed) â†’ Read twice â†’ Answer 3 questions</p>
                        <p><strong>C) Math Fluency (7-10 min):</strong> Reflex Math (5-10 min) + strategy support if needed</p>
                    </div>

                    <div class="tracker-section">
                        <h3>ğŸ“… Weekly Tracker - Week 1 (Dates: _________)</h3>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: #667eea;">This Week's Focus:</h4>
                            <input type="text" placeholder="Phonics focus..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Sight words..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Reading goal (Raz level/book)..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Math goal..." style="width: 100%; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                        </div>

                        <h4 style="margin-bottom: 15px; color: #117a8b;">Home Routine Completed:</h4>
                        <div class="day-checks">
                            <div class="day-check">
                                <input type="checkbox" id="w1-mon">
                                <label for="w1-mon">Monday</label>
                                <button class="comment-btn" id="cb-w1-mon" onclick="openComment('w1-mon', 'Monday')">ğŸ’¬</button>
                            </div>
                            <div class="day-check">
                                <input type="checkbox" id="w1-tue">
                                <label for="w1-tue">Tuesday</label>
                                <button class="comment-btn" id="cb-w1-tue" onclick="openComment('w1-tue', 'Tuesday')">ğŸ’¬</button>
                            </div>
                            <div class="day-check">
                                <input type="checkbox" id="w1-wed">
                                <label for="w1-wed">Wednesday</label>
                                <button class="comment-btn" id="cb-w1-wed" onclick="openComment('w1-wed', 'Wednesday')">ğŸ’¬</button>
                            </div>
                            <div class="day-check">
                                <input type="checkbox" id="w1-thu">
                                <label for="w1-thu">Thursday</label>
                                <button class="comment-btn" id="cb-w1-thu" onclick="openComment('w1-thu', 'Thursday')">ğŸ’¬</button>
                            </div>
                            <div class="day-check">
                                <input type="checkbox" id="w1-fri">
                                <label for="w1-fri">Friday</label>
                                <button class="comment-btn" id="cb-w1-fri" onclick="openComment('w1-fri', 'Friday')">ğŸ’¬</button>
                            </div>
                        </div>

                        <div class="week-progress-container" id="week1-progress">
                            <span>ğŸ“ˆ Week Progress:</span>
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="week1-progress-bar" style="width: 0%"></div>
                            </div>
                            <span class="week-progress-text" id="week1-progress-text">0%</span>
                        </div>
                        <div class="last-edited" id="week1-last-edited">No edits yet</div>

                        <h4 style="margin-bottom: 15px; margin-top: 25px; color: #117a8b;">Friday Progress Check:</h4>
                        <div class="progress-checks">
                            <div class="progress-item">
                                <label>ELA Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w1-ela')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w1-ela')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w1-ela')">âŒ Needs Support</button>
                                </div>
                            </div>
                            <div class="progress-item">
                                <label>Math Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w1-math')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w1-math')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w1-math')">âŒ Needs Support</button>
                                </div>
                            </div>
                        </div>

                        <div class="notes-area">
                            <label>ğŸ“ Notes / Adjustments for Next Week:</label>
                            <textarea id="w1-notes" placeholder="Enter your observations, concerns, or adjustments needed..."></textarea>
                        </div>

                        <button class="save-btn" onclick="saveWeekData(1)">ğŸ’¾ Save Week 1 Progress</button>
                    </div>
                </div>
            </div>

            <!-- Week 3-4 -->
            <div class="week-section collapsed" data-week="2">
                <div class="week-header" onclick="toggleWeek(this)">
                    <h2>ğŸ“— Weeks 3-4: Blends + Digraphs (High Classroom Payoff)</h2>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="week-content">
                    <div class="focus-area">
                        <h3>ğŸ“– ELA / Reading</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ”¤ Blending CCVC and CVCC words (consonant blends)</div>
                            <div class="focus-item">ğŸ“ Digraphs/trigraphs (sh, ch, th, wh, ph...)</div>
                            <div class="focus-item">ğŸ¯ Fluency: repeated reading for smoother blending</div>
                        </div>
                    </div>

                    <div class="focus-area">
                        <h3>ğŸ”¢ Math</h3>
                        <div class="focus-items">
                            <div class="focus-item">âš–ï¸ Compare numbers (greater than, less than, equal to)</div>
                            <div class="focus-item">ğŸ• Introduction to time (analog + digital)</div>
                            <div class="focus-item">ğŸ“Š Basic word problems (visual + simple equations)</div>
                        </div>
                    </div>

                    <div class="tracker-section">
                        <h3>ğŸ“… Weekly Tracker - Week 3 (Dates: _________)</h3>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: #667eea;">This Week's Focus:</h4>
                            <input type="text" placeholder="Phonics focus..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Sight words..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Reading goal..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Math goal..." style="width: 100%; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                        </div>

                        <h4 style="margin-bottom: 15px; color: #117a8b;">Home Routine Completed:</h4>
                        <div class="day-checks">
                            <div class="day-check"><input type="checkbox" id="w3-mon"><label for="w3-mon">Monday</label><button class="comment-btn" id="cb-w3-mon" onclick="openComment('w3-mon', 'Monday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w3-tue"><label for="w3-tue">Tuesday</label><button class="comment-btn" id="cb-w3-tue" onclick="openComment('w3-tue', 'Tuesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w3-wed"><label for="w3-wed">Wednesday</label><button class="comment-btn" id="cb-w3-wed" onclick="openComment('w3-wed', 'Wednesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w3-thu"><label for="w3-thu">Thursday</label><button class="comment-btn" id="cb-w3-thu" onclick="openComment('w3-thu', 'Thursday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w3-fri"><label for="w3-fri">Friday</label><button class="comment-btn" id="cb-w3-fri" onclick="openComment('w3-fri', 'Friday')">ğŸ’¬</button></div>
                        </div>

                        <div class="week-progress-container">
                            <span>ğŸ“ˆ Week Progress:</span>
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="week3-progress-bar" style="width: 0%"></div>
                            </div>
                            <span class="week-progress-text" id="week3-progress-text">0%</span>
                        </div>
                        <div class="last-edited" id="week3-last-edited">No edits yet</div>

                        <h4 style="margin-bottom: 15px; margin-top: 25px; color: #117a8b;">Friday Progress Check:</h4>
                        <div class="progress-checks">
                            <div class="progress-item">
                                <label>ELA Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w3-ela')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w3-ela')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w3-ela')">âŒ Needs Support</button>
                                </div>
                            </div>
                            <div class="progress-item">
                                <label>Math Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w3-math')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w3-math')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w3-math')">âŒ Needs Support</button>
                                </div>
                            </div>
                        </div>

                        <div class="notes-area">
                            <label>ğŸ“ Notes / Adjustments for Next Week:</label>
                            <textarea id="w3-notes" placeholder="Enter your observations..."></textarea>
                        </div>

                        <button class="save-btn" onclick="saveWeekData(3)">ğŸ’¾ Save Week 3 Progress</button>
                    </div>
                </div>
            </div>

            <!-- Week 5-6 -->
            <div class="week-section collapsed" data-week="3">
                <div class="week-header" onclick="toggleWeek(this)">
                    <h2>ğŸ“™ Weeks 5-6: Silent-e + Vowel Teams</h2>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="week-content">
                    <div class="focus-area">
                        <h3>ğŸ“– ELA / Reading</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ”¤ Silent-e (CVCe patterns: make, bike...)</div>
                            <div class="focus-item">ğŸ‘¥ Introduction to vowel teams (ai, ee, oa, ea...)</div>
                        </div>
                    </div>

                    <div class="focus-area">
                        <h3>ğŸ”¢ Math</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ“ Measurement (inches)</div>
                            <div class="focus-item">ğŸ”· Shapes (vertices and sides)</div>
                            <div class="focus-item">ğŸ• Simple fractions (halves and fourths)</div>
                        </div>
                    </div>

                    <div class="tracker-section">
                        <h3>ğŸ“… Weekly Tracker - Week 5 (Dates: _________)</h3>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: #667eea;">This Week's Focus:</h4>
                            <input type="text" placeholder="Phonics focus..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Sight words..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Reading goal..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Math goal..." style="width: 100%; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                        </div>

                        <h4 style="margin-bottom: 15px; color: #117a8b;">Home Routine Completed:</h4>
                        <div class="day-checks">
                            <div class="day-check"><input type="checkbox" id="w5-mon"><label for="w5-mon">Monday</label><button class="comment-btn" id="cb-w5-mon" onclick="openComment('w5-mon', 'Monday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w5-tue"><label for="w5-tue">Tuesday</label><button class="comment-btn" id="cb-w5-tue" onclick="openComment('w5-tue', 'Tuesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w5-wed"><label for="w5-wed">Wednesday</label><button class="comment-btn" id="cb-w5-wed" onclick="openComment('w5-wed', 'Wednesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w5-thu"><label for="w5-thu">Thursday</label><button class="comment-btn" id="cb-w5-thu" onclick="openComment('w5-thu', 'Thursday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w5-fri"><label for="w5-fri">Friday</label><button class="comment-btn" id="cb-w5-fri" onclick="openComment('w5-fri', 'Friday')">ğŸ’¬</button></div>
                        </div>

                        <div class="week-progress-container">
                            <span>ğŸ“ˆ Week Progress:</span>
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="week5-progress-bar" style="width: 0%"></div>
                            </div>
                            <span class="week-progress-text" id="week5-progress-text">0%</span>
                        </div>
                        <div class="last-edited" id="week5-last-edited">No edits yet</div>

                        <h4 style="margin-bottom: 15px; margin-top: 25px; color: #117a8b;">Friday Progress Check:</h4>
                        <div class="progress-checks">
                            <div class="progress-item">
                                <label>ELA Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w5-ela')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w5-ela')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w5-ela')">âŒ Needs Support</button>
                                </div>
                            </div>
                            <div class="progress-item">
                                <label>Math Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w5-math')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w5-math')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w5-math')">âŒ Needs Support</button>
                                </div>
                            </div>
                        </div>

                        <div class="notes-area">
                            <label>ğŸ“ Notes / Adjustments for Next Week:</label>
                            <textarea id="w5-notes" placeholder="Enter your observations..."></textarea>
                        </div>

                        <button class="save-btn" onclick="saveWeekData(5)">ğŸ’¾ Save Week 5 Progress</button>
                    </div>
                </div>
            </div>

            <!-- Week 7-8 -->
            <div class="week-section collapsed" data-week="4">
                <div class="week-header" onclick="toggleWeek(this)">
                    <h2>ğŸ“• Weeks 7-8: Integration + Targeted Repair</h2>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="week-content">
                    <div class="focus-area">
                        <h3>ğŸ“– ELA / Reading</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ”„ Mixed review of all phonics patterns (short daily review)</div>
                            <div class="focus-item">ğŸ“ Paragraph writing: topic + details</div>
                            <div class="focus-item">ğŸ¯ Fluency and comprehension support through repeated reading</div>
                        </div>
                    </div>

                    <div class="focus-area">
                        <h3>ğŸ”¢ Math</h3>
                        <div class="focus-items">
                            <div class="focus-item">ğŸ”„ Mixed review + additional word problems</div>
                            <div class="focus-item">ğŸ¯ Extra focus on the weakest Reflex Math area (based on results)</div>
                        </div>
                    </div>

                    <div class="tracker-section">
                        <h3>ğŸ“… Weekly Tracker - Week 7 (Dates: _________)</h3>
                        
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: #667eea;">This Week's Focus:</h4>
                            <input type="text" placeholder="Phonics focus..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Sight words..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Reading goal..." style="width: 100%; padding: 8px; margin-bottom: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                            <input type="text" placeholder="Math goal..." style="width: 100%; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px;">
                        </div>

                        <h4 style="margin-bottom: 15px; color: #117a8b;">Home Routine Completed:</h4>
                        <div class="day-checks">
                            <div class="day-check"><input type="checkbox" id="w7-mon"><label for="w7-mon">Monday</label><button class="comment-btn" id="cb-w7-mon" onclick="openComment('w7-mon', 'Monday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w7-tue"><label for="w7-tue">Tuesday</label><button class="comment-btn" id="cb-w7-tue" onclick="openComment('w7-tue', 'Tuesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w7-wed"><label for="w7-wed">Wednesday</label><button class="comment-btn" id="cb-w7-wed" onclick="openComment('w7-wed', 'Wednesday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w7-thu"><label for="w7-thu">Thursday</label><button class="comment-btn" id="cb-w7-thu" onclick="openComment('w7-thu', 'Thursday')">ğŸ’¬</button></div>
                            <div class="day-check"><input type="checkbox" id="w7-fri"><label for="w7-fri">Friday</label><button class="comment-btn" id="cb-w7-fri" onclick="openComment('w7-fri', 'Friday')">ğŸ’¬</button></div>
                        </div>

                        <div class="week-progress-container">
                            <span>ğŸ“ˆ Week Progress:</span>
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="week7-progress-bar" style="width: 0%"></div>
                            </div>
                            <span class="week-progress-text" id="week7-progress-text">0%</span>
                        </div>
                        <div class="last-edited" id="week7-last-edited">No edits yet</div>

                        <h4 style="margin-bottom: 15px; margin-top: 25px; color: #117a8b;">Friday Progress Check:</h4>
                        <div class="progress-checks">
                            <div class="progress-item">
                                <label>ELA Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w7-ela')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w7-ela')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w7-ela')">âŒ Needs Support</button>
                                </div>
                            </div>
                            <div class="progress-item">
                                <label>Math Result:</label>
                                <div class="status-buttons">
                                    <button class="status-btn mastered" onclick="setStatus(this, 'w7-math')">âœ… Mastered</button>
                                    <button class="status-btn developing" onclick="setStatus(this, 'w7-math')">ğŸŸ¡ Developing</button>
                                    <button class="status-btn needs-support" onclick="setStatus(this, 'w7-math')">âŒ Needs Support</button>
                                </div>
                            </div>
                        </div>

                        <div class="notes-area">
                            <label>ğŸ“ Notes / Adjustments for Next Week:</label>
                            <textarea id="w7-notes" placeholder="Enter your observations..."></textarea>
                        </div>

                        <button class="save-btn" onclick="saveWeekData(7)">ğŸ’¾ Save Week 7 Progress</button>
                    </div>
                </div>
            </div>

            <!-- Export Section -->
            <div class="export-section">
                <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“¤ Export & Share</h2>
                <p style="margin-bottom: 20px; color: #666;">Save your progress and share with teachers</p>
                <button class="export-btn" onclick="exportData()">ğŸ’¾ Download All Data (JSON)</button>
                <button class="export-btn" onclick="window.print()">ğŸ–¨ï¸ Print Plan</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDL-Pg0MJ_sDorFefIlyUwyeqZU1grQMH0",
            authDomain: "pera-support.firebaseapp.com",
            projectId: "pera-support",
            storageBucket: "pera-support.firebasestorage.app",
            messagingSenderId: "970307738932",
            appId: "1:970307738932:web:7f0aa87178389b13c65961"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Connection status indicator
        let isOnline = true;
        let currentCommentDay = null;

        // Get current user from localStorage
        function getCurrentUser() {
            return localStorage.getItem('peraUser') || '';
        }

        // Save current user to localStorage
        function saveCurrentUser() {
            const user = document.getElementById('currentUser').value;
            localStorage.setItem('peraUser', user);
            if (user) {
                showNotification(`ğŸ‘‹ Welcome, ${user}!`, 'success');
            }
        }

        // Load user on page load
        function loadCurrentUser() {
            const savedUser = getCurrentUser();
            if (savedUser) {
                document.getElementById('currentUser').value = savedUser;
            }
        }

        // Toggle week sections
        function toggleWeek(header) {
            const section = header.parentElement;
            section.classList.toggle('collapsed');
        }

        // Comment Modal Functions
        function openComment(dayId, dayLabel) {
            currentCommentDay = dayId;
            document.getElementById('commentDayLabel').textContent = dayLabel;
            document.getElementById('commentModal').classList.add('active');

            // Load existing comment
            const weekNum = dayId.match(/w(\d+)-/)[1];
            db.collection('weeks').doc(`week${weekNum}`).get().then(doc => {
                if (doc.exists && doc.data().dayComments && doc.data().dayComments[dayId]) {
                    document.getElementById('commentText').value = doc.data().dayComments[dayId];
                } else {
                    document.getElementById('commentText').value = '';
                }
            });
        }

        function closeCommentModal() {
            document.getElementById('commentModal').classList.remove('active');
            currentCommentDay = null;
        }

        function saveComment() {
            const comment = document.getElementById('commentText').value;
            const weekNum = currentCommentDay.match(/w(\d+)-/)[1];
            const user = getCurrentUser() || 'Anonymous';

            db.collection('weeks').doc(`week${weekNum}`).set({
                dayComments: { [currentCommentDay]: comment },
                lastEditedBy: user,
                lastEditedAt: firebase.firestore.FieldValue.serverTimestamp()
            }, { merge: true }).then(() => {
                showNotification('ğŸ’¬ Comment saved!', 'success');
                closeCommentModal();
                updateCommentButtons();
            });
        }

        // Update comment button styles
        function updateCommentButtons() {
            [1, 3, 5, 7].forEach(weekNum => {
                db.collection('weeks').doc(`week${weekNum}`).get().then(doc => {
                    if (doc.exists && doc.data().dayComments) {
                        Object.keys(doc.data().dayComments).forEach(dayId => {
                            const btn = document.getElementById(`cb-${dayId}`);
                            if (btn && doc.data().dayComments[dayId]) {
                                btn.classList.add('has-comment');
                            }
                        });
                    }
                });
            });
        }

        // Calculate and update progress bars
        function updateProgressBars() {
            const weekMapping = { 1: 1, 2: 3, 3: 5, 4: 7 };
            let totalChecked = 0;
            let totalCheckboxes = 0;

            [1, 3, 5, 7].forEach(weekNum => {
                const checkboxes = document.querySelectorAll(`input[id^="w${weekNum}-"]:checked`);
                const allCheckboxes = document.querySelectorAll(`input[id^="w${weekNum}-"][type="checkbox"]`);

                const checked = checkboxes.length;
                const total = allCheckboxes.length;
                const percent = total > 0 ? Math.round((checked / total) * 100) : 0;

                // Update week progress bar
                const progressBar = document.getElementById(`week${weekNum}-progress-bar`);
                const progressText = document.getElementById(`week${weekNum}-progress-text`);
                if (progressBar) progressBar.style.width = `${percent}%`;
                if (progressText) progressText.textContent = `${percent}%`;

                totalChecked += checked;
                totalCheckboxes += total;
            });

            // Update overall progress
            const overallPercent = totalCheckboxes > 0 ? Math.round((totalChecked / totalCheckboxes) * 100) : 0;
            document.getElementById('overallPercent').textContent = `${overallPercent}%`;
            document.getElementById('overallProgressBar').style.width = `${overallPercent}%`;
        }

        // Format time ago
        function timeAgo(timestamp) {
            if (!timestamp) return 'No edits yet';
            const now = new Date();
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const seconds = Math.floor((now - date) / 1000);

            if (seconds < 60) return 'just now';
            if (seconds < 3600) return `${Math.floor(seconds/60)} min ago`;
            if (seconds < 86400) return `${Math.floor(seconds/3600)} hours ago`;
            return `${Math.floor(seconds/86400)} days ago`;
        }

        // Update last edited info
        function updateLastEdited(weekNum, data) {
            const el = document.getElementById(`week${weekNum}-last-edited`);
            if (el && data.lastEditedBy) {
                el.textContent = `Last edited by ${data.lastEditedBy}, ${timeAgo(data.lastEditedAt)}`;
            }
        }

        // Show notification
        function showNotification(message, type) {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();

            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};
                color: white;
                border-radius: 8px;
                font-weight: bold;
                z-index: 9999;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // Set status for progress items
        function setStatus(button, groupName) {
            const buttons = button.parentElement.querySelectorAll('.status-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            // Save to Firebase
            const status = button.textContent.includes('Mastered') ? 'mastered' :
                          button.textContent.includes('Developing') ? 'developing' : 'needs-support';

            db.collection('progress').doc('statuses').set({
                [groupName]: status,
                lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
            }, { merge: true })
            .then(() => showNotification('âœ… Status saved!', 'success'))
            .catch(err => showNotification('âŒ Error saving', 'error'));
        }

        // Save week data
        function saveWeekData(weekNum) {
            const user = getCurrentUser() || 'Anonymous';
            const weekData = {
                week: weekNum,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                lastEditedBy: user,
                lastEditedAt: firebase.firestore.FieldValue.serverTimestamp(),
                completed: {}
            };

            // Save checkboxes
            const checkboxes = document.querySelectorAll(`input[id^="w${weekNum}-"]:not([type="text"])`);
            checkboxes.forEach(cb => {
                if (cb.type === 'checkbox') {
                    weekData.completed[cb.id] = cb.checked;
                }
            });

            // Save notes
            const notes = document.getElementById(`w${weekNum}-notes`);
            if (notes) {
                weekData.notes = notes.value;
            }

            // Save text inputs (focus areas)
            const section = document.querySelector(`[data-week="${Math.ceil(weekNum/2)}"]`);
            if (section) {
                const inputs = section.querySelectorAll('input[type="text"]');
                weekData.focusAreas = {};
                inputs.forEach((input, index) => {
                    weekData.focusAreas[`field${index}`] = input.value;
                });
            }

            // Save to Firebase
            db.collection('weeks').doc(`week${weekNum}`).set(weekData, { merge: true })
                .then(() => {
                    showNotification(`âœ… Week ${weekNum} saved!`, 'success');
                    updateProgressBars();
                })
                .catch(error => showNotification(`âŒ Error: ${error.message}`, 'error'));
        }

        // Export all data
        async function exportData() {
            showNotification('ğŸ“¥ Preparing export...', 'info');

            const allData = {
                exportDate: new Date().toISOString(),
                weeks: [],
                statuses: {}
            };

            try {
                // Get weeks data
                const weeksSnapshot = await db.collection('weeks').get();
                weeksSnapshot.forEach(doc => {
                    allData.weeks.push({ id: doc.id, ...doc.data() });
                });

                // Get statuses
                const statusDoc = await db.collection('progress').doc('statuses').get();
                if (statusDoc.exists) {
                    allData.statuses = statusDoc.data();
                }

                // Create download
                const dataStr = JSON.stringify(allData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `pera-progress-${new Date().toISOString().split('T')[0]}.json`;
                link.click();

                showNotification('âœ… Export complete!', 'success');
            } catch (error) {
                showNotification(`âŒ Export failed: ${error.message}`, 'error');
            }
        }

        // Load data from Firebase and listen for real-time updates
        window.addEventListener('load', function() {
            showNotification('ğŸ”„ Loading...', 'info');

            // Load saved user
            loadCurrentUser();

            // Listen for real-time updates on weeks
            db.collection('weeks').onSnapshot(snapshot => {
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const weekNum = data.week;

                    // Restore checkboxes
                    if (data.completed) {
                        Object.entries(data.completed).forEach(([id, checked]) => {
                            const checkbox = document.getElementById(id);
                            if (checkbox) checkbox.checked = checked;
                        });
                    }

                    // Restore notes
                    const notes = document.getElementById(`w${weekNum}-notes`);
                    if (notes && data.notes !== undefined) {
                        notes.value = data.notes;
                    }

                    // Restore focus areas
                    if (data.focusAreas) {
                        const section = document.querySelector(`[data-week="${Math.ceil(weekNum/2)}"]`);
                        if (section) {
                            const inputs = section.querySelectorAll('input[type="text"]');
                            inputs.forEach((input, index) => {
                                if (data.focusAreas[`field${index}`]) {
                                    input.value = data.focusAreas[`field${index}`];
                                }
                            });
                        }
                    }

                    // Update last edited info
                    updateLastEdited(weekNum, data);
                });

                // Update progress bars after data loads
                updateProgressBars();
                updateCommentButtons();
                showNotification('âœ… Saved!', 'success');
            }, error => {
                showNotification('âŒ Connection error', 'error');
                console.error('Firestore error:', error);
            });

            // Listen for real-time updates on statuses
            db.collection('progress').doc('statuses').onSnapshot(doc => {
                if (doc.exists) {
                    const data = doc.data();
                    Object.entries(data).forEach(([key, status]) => {
                        if (key !== 'lastUpdated') {
                            const buttons = document.querySelectorAll(`button[onclick*="${key}"]`);
                            buttons.forEach(btn => {
                                btn.classList.remove('active');
                                if (btn.classList.contains(status)) {
                                    btn.classList.add('active');
                                }
                            });
                        }
                    });
                }
            });
        });

        // Auto-save everything immediately
        let autoSaveTimer;
        document.addEventListener('change', function(e) {
            // Auto-save checkboxes
            if (e.target.matches('input[type="checkbox"]')) {
                const weekMatch = e.target.id.match(/w(\d+)-/);
                if (weekMatch) {
                    const weekNum = weekMatch[1];
                    const user = getCurrentUser() || 'Anonymous';
                    db.collection('weeks').doc(`week${weekNum}`).set({
                        week: parseInt(weekNum),
                        completed: { [e.target.id]: e.target.checked },
                        lastEditedBy: user,
                        lastEditedAt: firebase.firestore.FieldValue.serverTimestamp()
                    }, { merge: true });
                    updateProgressBars();
                    showNotification('âœ… Saved!', 'success');
                }
            }
        });

        // Auto-save text inputs and textareas with debounce
        document.addEventListener('input', function(e) {
            if (e.target.matches('input[type="text"], textarea')) {
                clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    // Find which week this belongs to
                    const section = e.target.closest('.week-section');
                    if (section) {
                        const weekNum = section.dataset.week === '1' ? 1 :
                                       section.dataset.week === '2' ? 3 :
                                       section.dataset.week === '3' ? 5 : 7;
                        saveWeekData(weekNum);
                    }
                }, 1500); // Save 1.5 seconds after user stops typing
            }
        });
    </script>
</body>
</html>